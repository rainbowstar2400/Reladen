# 2-2 データフロー
- 会話生成: クライアントで入力/条件を集約→GPT-APIへ送信→レスポンスを会話レコードとして保存し、必要に応じて新聞/掲示板にも反映。
- WorldFacts→Topic: バッチまたはイベントでWorldFactsを生成し、関連Topicを派生。優先度・期限を付与し、消化状況を管理。
- 同期: `updated_at`と`deleted`(tombstone)を基準にローカルとSupabaseを双方向同期。Offlineでの追加/更新/削除はキューに積み、オンライン復帰時に `/app/api/sync/{table}` へ送信。衝突時は更新日時優先かポリシーで解決。
- Realtime: Supabase Realtimeで他クライアントの更新を受信し、ローカルを更新(必要なら再同期)。
